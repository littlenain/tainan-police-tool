<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>臺南市警察多功能座標採集工具</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            /* 胭脂紅主色調 */
            --main-rose: #D05A6E;
            --main-rose-dark: #A54354;
            --main-rose-light: #F2D5D7;
            --bg-color: #F9F3F4;
            --text-color: #4A4A4A;
            /* 修正：匯出按鈕指定色 */
            --export-green: #24936E; 
        }

        body { 
            font-family: "Microsoft JhengHei", "PingFang TC", sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text-color); 
            margin: 0; 
            padding: 20px;
            font-size: 17px; 
        }

        .container { 
            max-width: 1550px; 
            margin: 0 auto; 
            background: white; 
            padding: 35px; 
            border-radius: 15px; 
            box-shadow: 0 8px 30px rgba(0,0,0,0.06); 
        }

        /* 標題區塊：標題純色，警車彩色 */
        .main-title {
            color: var(--main-rose);
            font-weight: 900;
            font-size: 2.6rem;
            margin: 0 0 30px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .police-car {
            -webkit-text-fill-color: initial; 
            font-size: 3rem;
        }

        .input-section { display: flex; gap: 30px; margin-bottom: 30px; }

        /* 左側控制面板：寬度 265px */
        .form-panel { 
            width: 265px; 
            flex-shrink: 0; 
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .card {
            background: #ffffff;
            border: 1px solid #E8E8E8;
            border-radius: 12px;
            padding: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.02);
        }

        .card-header {
            font-weight: 800;
            font-size: 1.1rem;
            color: var(--main-rose-dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-left: 5px solid var(--main-rose);
            padding-left: 12px;
        }

        /* 地圖區域 */
        #map-container { 
            flex-grow: 1; 
            height: 680px; 
            border-radius: 15px; 
            overflow: hidden; 
            border: 5px solid #fff;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        #map { height: 100%; width: 100%; z-index: 1; }

        /* 表單元素：寬度嚴格對齊 */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; font-weight: 700; font-size: 1rem; color: #666; }
        
        input, select { 
            width: 100%; 
            padding: 12px; 
            border: 2px solid #EAEAEA; 
            border-radius: 8px; 
            font-size: 16px; 
            color: var(--text-color);
            box-sizing: border-box; 
            transition: all 0.3s ease;
        }
        input:focus, select:focus { border-color: var(--main-rose); outline: none; background: #FFFBFB; }

        /* 按鈕設計 */
        .btn {
            border: none;
            border-radius: 8px;
            padding: 14px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.05rem;
        }

        .btn-add { background: var(--main-rose); color: white; width: 100%; }
        .btn-add:hover { background: var(--main-rose-dark); box-shadow: 0 4px 12px rgba(208, 90, 110, 0.3); }

        /* 修正匯出按鈕：使用 #24936E */
        .btn-export { background: var(--export-green); color: white; }
        .btn-export:hover { filter: brightness(1.1); box-shadow: 0 4px 12px rgba(36, 147, 110, 0.3); }
        
        .btn-clear { background: #E0E0E0; color: #555; }

        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px